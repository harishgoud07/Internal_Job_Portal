 <?php
$active_posts_data = $this->posts_data;
$projects_list = $this->projects_list;
$requested_posts_count = $this->requested_posts_count;
$this->headScript()->appendFile($this->baseUrl('externals\js\admin.js'));
$this->headScript()->appendFile($this->baseUrl('externals\js\employee.js'));
$utilities = new application_models_Utilities();
$user_details = $utilities->get_user_details();
$user_role = $user_details->user_role;
if($user_role == 'E'){
    $display_count = isset($this->applied_posts_count)? $this->applied_posts_count :0;
}else { //if($user_role == 'A'){
    $display_count = isset($this->requested_posts_count)? $this->requested_posts_count :0; 
}/*else if($user_role == 'M'){
    $display_count = isset($this->requested_posts_count)? $this->requested_posts_count :0; 
}*/



 ?>
 
 
 
 <div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1 col-sm-10 col-sm-offset-1 col-xs-10 col-xs-offset-1">
 <div class="row">
 <?php
             if($user_role == 'M' || $user_role == 'A'){
?>
             <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                    <button onclick="window.location='/admin/jobpostrequests'" class="btn"><?php echo $user_role != 'M'? 'Job post requests' : 'Requested Job Posts'?><span class="badge"><?php echo $display_count;?></span></button>
                </div>
                <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                    <button  id='add-job-trigger'  data-toggle="modal" class="btn pull-right">Add a new Job post</button>
                </div>
<?php
 }else{
	 if(!$this->display_applied_posts){
?>
<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                    <button onclick="window.location='/posts/displayappliedjobposts'" class="btn">View Applied Job posts <span class="badge"><?php echo $display_count;?></span></button>
                </div>

<?php
	 }else{
		 ?>
<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                    <button onclick="window.location='/'" class="btn">Browse all posts </span></button>
                </div>

<?php		 
	 }
 }
 ?>

               
            </div>
 </div>
 <div class='col-lg-12 jobs-list-container'>
<?php echo $this->partial('posts/includes/postsdisplay.phtml', array(
    'active_posts_data' => $this->posts_data)); ?>
</div>
<?php if($user_role != 'E'){
    ?>
     <div id="add-new-job" class="modal fade" tabindex="-1" role="dialog" style="display: none;">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button>
                    <h4 class="modal-title">Add/Update a Job Post</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1 col-sm-10 col-sm-offset-1 col-xs-10 col-xs-offset-1">
                            <form class="form-horizontal" id='add_posts' method = 'POST'>
                            	<input type="text" hidden="true" name="job_id">
                            	<div class="row">
                            		<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                            			<div class="form-group">
		                                	<label for="project_name">Project Name</label>
		                                    <select required class="form-control" name="project_name" id="project_name">
		                                    <option value=''>SELECT</option>
		                                    <?php
		                                    if($projects_list){
		                                        foreach($projects_list as $project_data){
		                                           echo "<option value='".$project_data['project_id']."' >".$project_data['name']."</option>"; 
		                                                                                       
		                                        }
		                                    }
		                             	           
		                                	    ?>
		                                            
		                                    </select>
		                                </div>
                            		</div>
                            		<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                            				<div class="form-group">
			                                    <div class="">
			                                    	<label for="job_title">Job Title</label>
			                                        <input required type="text" class="form-control" name="job_title" id="job_title" placeholder="">
			                                    </div>
			                                </div>
                            		</div>
                            	</div>
                                
                                <div class="row">
                            		<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                            			<div class="form-group">
		                                    <div class="">
		                                    	<label for="no_of_vacancies">Number of vacancies</label>
		                                        <input required type="number"  min = "0" class="form-control" name="no_of_vacancies" id="no_of_vacancies" placeholder="">
		                                    </div>
		                                </div>
                            		</div>
                            		<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                            			<div class="form-group">
		                                    <div class="">
		                                    	<label for="salary">Salary</label>
		                                        <input required type="text" class="form-control" name="salary" id="salary" placeholder="">
		                                    </div>
		                                </div>
                            		</div>
                            	</div>
                            	
                            	<div class="row">
                            		<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                            			<div class="form-group">
		                                    <div class="">
		                                    	<label for="experience">Experience required(Years)</label>
		                                        <input required  type="number" min = "0" class="form-control" name="experience" id="experience" placeholder="">
		                                    </div>
		                                </div>
                            		</div>
                            		<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                            			<div class="form-group">							
		                                	<label for="expiry_date">End date for Applicants</label>
		                                    <div class="input-group date post-job-date-control" >
			                                    <input required name="last_date_for_applicants" type="text" id="expiry_date_datepicker" class="form-control">
			                                    <span class="input-group-addon">
			                                        <span class="glyphicon glyphicon-calendar"></span>
			                                    </span>
			                                </div>
		                                </div>
                            		</div>
                            	</div>
                                
                                <div class="form-group">
                                	<div class="">
                                		<label for="key_skills">Required Key skills</label>
                                		<select required name="key_skills" id="key_skills" data-placeholder=" " class="form-control" multiple tabindex="-1">
								        <option value="Empty">&nbsp;</option>
								        <optgroup label="NFC EAST">
								          <option>Dallas Cowboys</option>
								          <option>New York Giants</option>
								          <option>Philadelphia Eagles</option>
								          <option>Washington Redskins</option>
								        </optgroup>
								      </select>
                                	</div>
                                </div>	
                                
                                <div class="form-group">
                                    <div class="">
                                    	<label for="job_description">Job Description</label>
                                        <textarea required name="job_description" id="job_description" class="form-control" rows="3"></textarea>
                                    </div>
                                </div>		
                                
                            </form>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id ='save_post'>Save changes</button>
                </div>
            </div>
            <!-- /.modal-content -->								
        </div>
        <!-- /.modal-dialog -->
        <?php
            }       
        ?>
    </div>